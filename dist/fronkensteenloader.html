<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="private, max-age=604800, immutable">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Fronkensteen">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <link rel="shortcut icon" id="favicon-png" type="image/png" href="data:;base64,iVBORw0KGgo=">
    <title>Fronkensteen Loader</title>
    <style>
      body{
        position:relative;
        height:100%;
        background-color: #f5f5f0;
        padding:4em;
        font-size:20px;
      }
      #credits{
        font-size:50%;
        position:relative;
        margin-top:10em;
        bottom:0;
      }
    </style>
  </head>
  <body id="fronkensteen-loader-content-container">
    <noscript id="noscript">
      Yeah, there's absolutely no way this can work with JavaScript turned off. Sorry, my friend.
    </noscript>
    <div>
      <h1>Fronkensteen Loader: launch a local HTML file on iOS</h1>
        Fronkensteen Loader lets you load and run HTML web apps (such as <a href="https://pulpgrinder.github.io/fronkensteen.html">Fronkensteen</a>) from the file system on your iOS device.
    </div>
    <div>
      Choose an HTML file: <input type="file" id="filechooser" accept=".html" multiple="false" onchange="launchFile()" />
    </div>
    <h1>Installation</h1>
    <div>
      For maximum convenience, you should install Fronkensteen Loader on your device's home screen. To do that, touch the <img src="share.png" width="20px" height="20px"/> share icon in Safari, then choose "Add to Home Screen".
    </div>
    <h1>Usage</h1>
    <div>
      Start Fronkensteen Loader from your device's home screen, tap the Choose Files input, then choose the Fronkensteen file you want to launch. Depending on where you saved it, you may need to browse around a bit to find it (possible locations include "On my Phone/iPad" or "Downloads")
    </div>


    <div id="credits">
      Share icon courtesy of <a href="https://www.flaticon.com/authors/those-icons" title="Those Icons">Those Icons</a> from <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a>
    </div>
</body>
<script type="text/javascript">
  var filechooser = document.getElementById("filechooser")
  function launchFile(){
      let curFiles = filechooser.files;
      let reader = new FileReader();
      reader.onloadend = (function(filename) {
        return function(evt) {
          alert(filename + " uploaded");
          document.open();
          document.write(evt.target.result);
          document.close();
          //intp2.invoke_closure(proc, [filename, evt.target.result]);
        };
      })(curFiles[0].name);
      reader.readAsText(curFiles[0]);
      }
</script>
